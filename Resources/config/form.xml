<?xml version="1.0" encoding="UTF-8" ?>

<container xmlns="http://symfony.com/schema/dic/services"
		   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		   xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

	<parameters>

		<parameter key="integrated_content.form.factory.event_dispatcher.class">Symfony\Component\EventDispatcher\EventDispatcher</parameter>
		<parameter key="integrated_content.form.factory.class">Integrated\Common\Content\Form\FormFactory</parameter>

        <parameter key="integrated_content.form.relations.class">Integrated\Bundle\ContentBundle\Form\Type\Relations</parameter>
		<parameter key="integrated_content.form.relations.listener.class">Integrated\Bundle\ContentBundle\EventListener\RelationsFormSubscriber</parameter>

        <parameter key="integrated_content.form_type_image.class">Integrated\Bundle\ContentBundle\Form\Type\Image</parameter>

	</parameters>

	<services>

		<service id="integrated_content.form.factory.event_dispatcher" class="%integrated_content.form.factory.event_dispatcher.class%" public="false" />

		<service id="integrated_content.form.factory" class="%integrated_content.form.factory.class%">
			<argument type="service" id="integrated_content.resolver.priority"/>
            <argument type="service" id="integrated_content.metadata.factory"/>

			<call method="setEventDispatcher">
				<argument type="service" id="integrated_content.form.factory.event_dispatcher" />
			</call>
		</service>

		<service id="integrated.form.resolver" alias="integrated_content.resolver.priority" />
		<service id="integrated.form.factory" alias="integrated_content.form.factory" />

		<service id="integrated_content.form.relations" class="%integrated_content.form.relations.class%">
			<argument type="service" id="doctrine_mongodb"/>

			<tag name="form.type" alias="integrated_relations" />
		</service>

		<service id="integrated_content.form.relations.listener" class="%integrated_content.form.relations.listener.class%">
			<argument type="string">relations</argument>
			<argument type="string">integrated_relations</argument>

			<tag name="integrated_content.form.event_subscriber" />
		</service>

        <service id="integrated_content.form_type_image" class="%integrated_content.form_type_image.class%">
            <tag name="form.type" alias="integrated_image" />
        </service>

	</services>

</container>