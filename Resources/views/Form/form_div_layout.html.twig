{% use "BraincraftedBootstrapBundle:Form:bootstrap.html.twig" %}

{% block integrated_datetime_widget  %}
    {% spaceless %}
        <div class="input-group date form_datetime" data-locale="{{ app.request.locale }}" style="width: 230px;" data-date="" data-date-format="dd-m-yyyy - HH:ii">
            <input {{ block('widget_attributes') }} class="form-control" size="16" type="text" {% if value is not empty %}value="{{ value }}" {% endif %} readonly>
            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
        </div>
    {% endspaceless %}
{% endblock %}

{% block integrated_wysihtml5x_widget  %}
        <textarea {{ block('widget_attributes') }}   class="form-control integrated_wysihtml5x"> {% if value is not empty %} {{ value }} {% endif %}  </textarea>
{% endblock %}

{% block integrated_tinymce_row  %}
    {% spaceless %}
    
    {# @todo to this include with a Twig extension #}
    <link href="/bundles/integratedformtype/css/tinymce.editor.js" rel="stylesheet" type="text/css" />

    <div class="form-group">
      <div class="col-sm-12">
	    <div id="{{ id }}_container">
	      <textarea id="{{ id }}" name="{{ full_name }}" class="form-control integrated_tinymce">{% if value is not empty %}{{ value }}{% endif %}</textarea>
	    </div>
	  </div>
	</div>
    <script type="text/javascript">
        require(["{{ asset('bundles/integratedformtype/components/tinymce/tinymce.min.js') }}"],
                function () {
                    tinymce.init({
                        selector: "textarea#{{ id }}",
                        theme: "modern",
                        plugins: [
                            ["advlist autolink link image lists charmap hr anchor pagebreak"],
                            ["searchreplace wordcount visualchars fullscreen media nonbreaking"],
                            ["table contextmenu directionality template paste wordcount autoresize"]
                        ],
                        add_unload_trigger: false,
                        schema: "html5",
                        menubar: false,
                        toolbar: "formatselect | bold italic underline | bullist numlist | link image print preview media fullpage table | charmap pagebreak | pastetext searchreplace fullscreen",
                        statusbar: true,
                        statusbar_size: "small",
                        width: "100%",
                        height: "0",
                        autoresize_min_height: 300,
                        autoresize_max_height: (window.innerHeight-64),
                        browser_spellcheck : true,
                        autoresize_bottom_margin: "0px",
                        
                        content_css: "/bundles/integratedformtype/css/tinymce.content.css"

                    });
                }
        );
        </script>
    {% endspaceless %}
{% endblock %}

{% block checkbox_row %}
    {% spaceless %}
        {% set style = style|default(bootstrap_get_style()) %}
        {% if style == 'horizontal' and (align_widget is defined or attr.align_widget is defined) %}
            {% set align_with_widget = true %}
        {% endif %}

        {{ parent() }}
    {% endspaceless %}
{% endblock %}

{% block radio_row %}
    {% spaceless %}
        {% set style = style|default(bootstrap_get_style()) %}
        {% if style == 'horizontal' and (align_widget is defined or attr.align_widget is defined) %}
            {% set align_with_widget = true %}
        {% endif %}

        {{ parent() }}
    {% endspaceless %}
{% endblock %}

{% block integrated_sortable_collection_widget %}
    {% spaceless %}
        {% if prototype is defined %}
            {% set prototype_vars = {} %}
            {% if style is defined %}
                {% set prototype_vars = prototype_vars|merge({'style': style}) %}
            {% endif %}

            {% set prototype_html = '<a data-toggle="collapse" href="#__id__">Item</a>' %}
            {% if form.vars.allow_delete %}
                {% set prototype_html = prototype_html ~ '<a href="javascript:;" class="pull-right" title="' ~ form.vars.delete_button_text|trans({}, translation_domain) ~ '" data-removefield="collection" data-field="__id__"><span class="glyphicon glyphicon-remove"></span></a>' %}
            {% endif %}
            {% set prototype_html = '<div class="panel-heading"><h4 class="panel-title">' ~ prototype_html ~ '</h4></div>' %}
            {% set prototype_html = prototype_html ~ '<div class="panel-collapse collapse in"><div class="panel-body">' ~ form_widget(prototype, prototype_vars) ~ '</div></div>' %}
            {% set prototype_html = '<div class="panel panel-default">' ~ prototype_html ~ '</div>' %}

            {% set attr = attr|merge({'data-prototype': prototype_html }) %}
            {% set attr = attr|merge({'data-prototype-name': prototype_name }) %}
        {% endif %}
        <div {{ block('widget_container_attributes') }}>
            <ul class="bc-collection panel-group sortable-collection">
                {% for field in form %}

                    <li>
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a data-toggle="collapse" href="#{{ field.vars.id }}">
                                        {{ field.vars.value.title|default('Item') }}
                                    </a>

                                    {% if form.vars.allow_delete %}
                                        <a href="javascript:;" class="pull-right" title="{{ form.vars.delete_button_text|trans({}, translation_domain) }}" data-removefield="collection" data-field="{{ field.vars.id }}">
                                            <span class="glyphicon glyphicon-remove"></span>
                                        </a>
                                    {% endif %}
                                </h4>
                            </div>
                            <div id="{{ field.vars.id }}" class="panel-collapse collapse">
                                <div class="panel-body">
                                    {{ form_widget(field) }}
                                    {{ form_errors(field) }}
                                </div>
                            </div>
                        </div>
                    </li>

                {% endfor %}
            </ul>

            {% if form.vars.allow_add %}
                <a href="javascript:;" title="{{ form.vars.add_button_text|trans({}, translation_domain) }}" data-addfield="collection" data-collection="{{ form.vars.id }}" data-prototype-name="{{ prototype_name }}">
                    <span class="glyphicon glyphicon-plus" style="margin-top: 5px;"></span>
                </a>
            {% endif %}
        </div>
    {% endspaceless %}
{% endblock %}