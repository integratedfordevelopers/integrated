{% block integrated_block_size_widget %}
{% spaceless %}
    {{ bootstrap_set_col_size('sm') }}

    <div class="row">
        <div class="col-sm-8">
            <div class="form-group">
                {{ form_label(form.block) }}
                <div class="col-sm-9">
                    {{ form_widget(form.block) }}
                </div>
            </div>
        </div>

        <div class="col-sm-4">
            <div class="form-group">
                {{ form_label(form.size) }}
                <div class="col-sm-9">
                    {{ form_widget(form.size) }}
                </div>
            </div>
        </div>
    </div>
{% endspaceless %}
{% endblock %}

{% block form_row %}
    {% spaceless %}
        {% set style = style|default(bootstrap_get_style()) %}
        {% set col_size = col_size|default(bootstrap_get_col_size()) %}

        {% if attr.label_col is defined and attr.label_col is not empty %}
            {% set label_col = attr.label_col %}
        {% endif %}
        {% if attr.widget_col is defined and attr.widget_col is not empty %}
            {% set widget_col = attr.widget_col %}
            {% if label is sameas(false) and label_col is defined %}
                {% set widget_col = widget_col + label_col %}
            {% endif %}
        {% endif %}
        {% if attr.col_size is defined and attr.col_size is not empty %}
            {% set col_size = attr.col_size %}
        {% endif %}
        {% if attr.style is defined and attr.style is not empty %}
            {% set style = attr.style %}
        {% endif %}

        {% set label_col = label_col|default(bootstrap_get_label_col()) %}
        {% set widget_col = widget_col|default(bootstrap_get_widget_col()) %}

        <div class="aside-item-holder{% if form.vars.errors|length > 0 %} has-error{% endif %}">
            {% if style == 'horizontal' %}
                <h3 class="font-medium">{{ form_label(form) }}</h3>

                <div class="col-{{ col_size }}-{{ widget_col }}">
                    {{ block('form_input_group') }}
                    {{ block('form_help') }}
                    {{ form_errors(form) }}
                </div>
            {% else %}
                <h3 class="font-medium">{{ form_label(form) }}</h3>
                {{ block('form_input_group') }}
                {{ block('form_help') }}
                {{ form_errors(form) }}
            {% endif %}
        </div>

        {% if style == 'inline' %}&nbsp;{% endif %}
    {% endspaceless %}
{% endblock form_row %}

{% block form_input_group %}
    {% spaceless %}
        {% if attr.input_group is defined and attr.input_group is not empty %}
            {% set input_group = attr.input_group %}
        {% endif %}
        {% set input_group = input_group|default({}) %}
        {% if input_group is not empty %}
            {% set ig_size_class = '' %}
            {% if input_group.size is defined and input_group.size == 'large' %}
                {% set ig_size_class = ' input-group-lg' %}
            {% endif  %}
            {% if input_group.size is defined and input_group.size == 'small' %}
                {% set ig_size_class = ' input-group-sm' %}
            {% endif  %}
            <div class="input-group{{ ig_size_class }}">
                {% if input_group.prepend is defined and input_group.prepend is not empty %}
                    <span class="input-group-addon">{{ input_group.prepend|raw|parse_icons }}</span>
                {% endif %}
                {% if input_group.button_prepend is defined and input_group.button_prepend is not empty %}
                    <span class="input-group-btn">{{ form_widget(input_group_button_prepend) }}</span>
                {% endif %}
                {{ form_widget(form) }}
                {% if input_group.button_append is defined and input_group.button_append is not empty %}
                    <span class="input-group-btn">{{ form_widget(input_group_button_append) }}</span>
                {% endif %}
                {% if input_group.append is defined and input_group.append is not empty %}
                    <span class="input-group-addon">{{ input_group.append|raw|parse_icons }}</span>
                {% endif %}
            </div>
        {% else %}
            {{ form_widget(form) }}
        {% endif %}
    {% endspaceless %}
{% endblock form_input_group %}

{# @todo
{% block integrated_block_widget %}
{% spaceless %}
    {{ form(form) }}

    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function(e) {

            $('#{{ form.vars.id }}').select2({
                ajax: {
                    url: '{{ path('integrated_block_block_index', { '_format': 'json' }) }}',
                    dataType: 'json',
                    data: function (term, page) {
                        return {
                            q: term,
                            page: page,
                            limit: 20,
                            _format: 'json'
                        };
                    },
                    results: function (data, page) {
                        return {
                            results: $.map(data.items, function (item) {
                                return {
                                    id: item.id,
                                    text: item.title
                                }
                            }),
                            more: (page * data.pagination.numItemsPerPage) < data.pagination.numFound
                        };
                    }
                }
            });
        });
    </script>
{% endspaceless %}
{% endblock %}
#}
